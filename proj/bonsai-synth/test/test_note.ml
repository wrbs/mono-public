open! Core
open Bonsai_synth

let%expect_test "Show table" =
  let notes = Midi_value.all |> List.map ~f:Note.of_midi_value in
  Ascii_table.to_string
    [ Ascii_table.Column.create "midi" (fun note ->
        note |> Note.to_midi_value_exn |> Midi_value.to_string)
    ; Ascii_table.Column.create "note" (fun note ->
        try Note.to_aligned_string_exn note with
        | _ -> "-")
    ; Ascii_table.Column.create "frequency" (fun note ->
        Note.frequency note |> Float.to_string_hum ~decimals:2)
    ; Ascii_table.Column.create "to_string" Note.to_string
    ]
    notes
  |> print_endline;
  [%expect
    {|
    ┌──────┬──────┬───────────┬───────────┐
    │ midi │ note │ frequency │ to_string │
    ├──────┼──────┼───────────┼───────────┤
    │ 0    │ -    │ 8.18      │ C-1       │
    │ 1    │ -    │ 8.66      │ C#-1      │
    │ 2    │ -    │ 9.18      │ D-1       │
    │ 3    │ -    │ 9.72      │ D#-1      │
    │ 4    │ -    │ 10.30     │ E-1       │
    │ 5    │ -    │ 10.91     │ F-1       │
    │ 6    │ -    │ 11.56     │ F#-1      │
    │ 7    │ -    │ 12.25     │ G-1       │
    │ 8    │ -    │ 12.98     │ G#-1      │
    │ 9    │ -    │ 13.75     │ A-1       │
    │ 10   │ -    │ 14.57     │ A#-1      │
    │ 11   │ -    │ 15.43     │ B-1       │
    │ 12   │ C-0  │ 16.35     │ C0        │
    │ 13   │ C#0  │ 17.32     │ C#0       │
    │ 14   │ D-0  │ 18.35     │ D0        │
    │ 15   │ D#0  │ 19.45     │ D#0       │
    │ 16   │ E-0  │ 20.60     │ E0        │
    │ 17   │ F-0  │ 21.83     │ F0        │
    │ 18   │ F#0  │ 23.12     │ F#0       │
    │ 19   │ G-0  │ 24.50     │ G0        │
    │ 20   │ G#0  │ 25.96     │ G#0       │
    │ 21   │ A-0  │ 27.50     │ A0        │
    │ 22   │ A#0  │ 29.14     │ A#0       │
    │ 23   │ B-0  │ 30.87     │ B0        │
    │ 24   │ C-1  │ 32.70     │ C1        │
    │ 25   │ C#1  │ 34.65     │ C#1       │
    │ 26   │ D-1  │ 36.71     │ D1        │
    │ 27   │ D#1  │ 38.89     │ D#1       │
    │ 28   │ E-1  │ 41.20     │ E1        │
    │ 29   │ F-1  │ 43.65     │ F1        │
    │ 30   │ F#1  │ 46.25     │ F#1       │
    │ 31   │ G-1  │ 49.00     │ G1        │
    │ 32   │ G#1  │ 51.91     │ G#1       │
    │ 33   │ A-1  │ 55.00     │ A1        │
    │ 34   │ A#1  │ 58.27     │ A#1       │
    │ 35   │ B-1  │ 61.74     │ B1        │
    │ 36   │ C-2  │ 65.41     │ C2        │
    │ 37   │ C#2  │ 69.30     │ C#2       │
    │ 38   │ D-2  │ 73.42     │ D2        │
    │ 39   │ D#2  │ 77.78     │ D#2       │
    │ 40   │ E-2  │ 82.41     │ E2        │
    │ 41   │ F-2  │ 87.31     │ F2        │
    │ 42   │ F#2  │ 92.50     │ F#2       │
    │ 43   │ G-2  │ 98.00     │ G2        │
    │ 44   │ G#2  │ 103.83    │ G#2       │
    │ 45   │ A-2  │ 110.00    │ A2        │
    │ 46   │ A#2  │ 116.54    │ A#2       │
    │ 47   │ B-2  │ 123.47    │ B2        │
    │ 48   │ C-3  │ 130.81    │ C3        │
    │ 49   │ C#3  │ 138.59    │ C#3       │
    │ 50   │ D-3  │ 146.83    │ D3        │
    │ 51   │ D#3  │ 155.56    │ D#3       │
    │ 52   │ E-3  │ 164.81    │ E3        │
    │ 53   │ F-3  │ 174.61    │ F3        │
    │ 54   │ F#3  │ 185.00    │ F#3       │
    │ 55   │ G-3  │ 196.00    │ G3        │
    │ 56   │ G#3  │ 207.65    │ G#3       │
    │ 57   │ A-3  │ 220.00    │ A3        │
    │ 58   │ A#3  │ 233.08    │ A#3       │
    │ 59   │ B-3  │ 246.94    │ B3        │
    │ 60   │ C-4  │ 261.63    │ C4        │
    │ 61   │ C#4  │ 277.18    │ C#4       │
    │ 62   │ D-4  │ 293.66    │ D4        │
    │ 63   │ D#4  │ 311.13    │ D#4       │
    │ 64   │ E-4  │ 329.63    │ E4        │
    │ 65   │ F-4  │ 349.23    │ F4        │
    │ 66   │ F#4  │ 369.99    │ F#4       │
    │ 67   │ G-4  │ 392.00    │ G4        │
    │ 68   │ G#4  │ 415.30    │ G#4       │
    │ 69   │ A-4  │ 440.00    │ A4        │
    │ 70   │ A#4  │ 466.16    │ A#4       │
    │ 71   │ B-4  │ 493.88    │ B4        │
    │ 72   │ C-5  │ 523.25    │ C5        │
    │ 73   │ C#5  │ 554.37    │ C#5       │
    │ 74   │ D-5  │ 587.33    │ D5        │
    │ 75   │ D#5  │ 622.25    │ D#5       │
    │ 76   │ E-5  │ 659.26    │ E5        │
    │ 77   │ F-5  │ 698.46    │ F5        │
    │ 78   │ F#5  │ 739.99    │ F#5       │
    │ 79   │ G-5  │ 783.99    │ G5        │
    │ 80   │ G#5  │ 830.61    │ G#5       │
    │ 81   │ A-5  │ 880.00    │ A5        │
    │ 82   │ A#5  │ 932.33    │ A#5       │
    │ 83   │ B-5  │ 987.77    │ B5        │
    │ 84   │ C-6  │ 1_046.50  │ C6        │
    │ 85   │ C#6  │ 1_108.73  │ C#6       │
    │ 86   │ D-6  │ 1_174.66  │ D6        │
    │ 87   │ D#6  │ 1_244.51  │ D#6       │
    │ 88   │ E-6  │ 1_318.51  │ E6        │
    │ 89   │ F-6  │ 1_396.91  │ F6        │
    │ 90   │ F#6  │ 1_479.98  │ F#6       │
    │ 91   │ G-6  │ 1_567.98  │ G6        │
    │ 92   │ G#6  │ 1_661.22  │ G#6       │
    │ 93   │ A-6  │ 1_760.00  │ A6        │
    │ 94   │ A#6  │ 1_864.66  │ A#6       │
    │ 95   │ B-6  │ 1_975.53  │ B6        │
    │ 96   │ C-7  │ 2_093.00  │ C7        │
    │ 97   │ C#7  │ 2_217.46  │ C#7       │
    │ 98   │ D-7  │ 2_349.32  │ D7        │
    │ 99   │ D#7  │ 2_489.02  │ D#7       │
    │ 100  │ E-7  │ 2_637.02  │ E7        │
    │ 101  │ F-7  │ 2_793.83  │ F7        │
    │ 102  │ F#7  │ 2_959.96  │ F#7       │
    │ 103  │ G-7  │ 3_135.96  │ G7        │
    │ 104  │ G#7  │ 3_322.44  │ G#7       │
    │ 105  │ A-7  │ 3_520.00  │ A7        │
    │ 106  │ A#7  │ 3_729.31  │ A#7       │
    │ 107  │ B-7  │ 3_951.07  │ B7        │
    │ 108  │ C-8  │ 4_186.01  │ C8        │
    │ 109  │ C#8  │ 4_434.92  │ C#8       │
    │ 110  │ D-8  │ 4_698.64  │ D8        │
    │ 111  │ D#8  │ 4_978.03  │ D#8       │
    │ 112  │ E-8  │ 5_274.04  │ E8        │
    │ 113  │ F-8  │ 5_587.65  │ F8        │
    │ 114  │ F#8  │ 5_919.91  │ F#8       │
    │ 115  │ G-8  │ 6_271.93  │ G8        │
    │ 116  │ G#8  │ 6_644.88  │ G#8       │
    │ 117  │ A-8  │ 7_040.00  │ A8        │
    │ 118  │ A#8  │ 7_458.62  │ A#8       │
    │ 119  │ B-8  │ 7_902.13  │ B8        │
    │ 120  │ C-9  │ 8_372.02  │ C9        │
    │ 121  │ C#9  │ 8_869.84  │ C#9       │
    │ 122  │ D-9  │ 9_397.27  │ D9        │
    │ 123  │ D#9  │ 9_956.06  │ D#9       │
    │ 124  │ E-9  │ 10_548.08 │ E9        │
    │ 125  │ F-9  │ 11_175.30 │ F9        │
    │ 126  │ F#9  │ 11_839.82 │ F#9       │
    │ 127  │ G-9  │ 12_543.85 │ G9        │
    └──────┴──────┴───────────┴───────────┘
    |}]
;;
