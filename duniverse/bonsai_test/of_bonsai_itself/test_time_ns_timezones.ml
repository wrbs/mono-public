open! Core

let%expect_test "Daylight saving switch" =
  (* This test is a small test that prints out the behavior of Time_ns when the daylight
     savings switch occurs. *)
  let time = Time_ns.of_string "2025-03-29 00:00:00" in
  List.iter (List.init 48 ~f:Fn.id) ~f:(fun hour_offset ->
    print_endline
      (Time_ns.to_string_abs
         ~zone:(Timezone.find_exn "Europe/London")
         (Time_ns.add time (Time_ns.Span.of_hr (1.0 *. Int.to_float hour_offset)))));
  (* NOTE: We skip 1:00am during the daylight savings switch. *)
  [%expect
    {|
    2025-03-29 04:00:00.000000000Z
    2025-03-29 05:00:00.000000000Z
    2025-03-29 06:00:00.000000000Z
    2025-03-29 07:00:00.000000000Z
    2025-03-29 08:00:00.000000000Z
    2025-03-29 09:00:00.000000000Z
    2025-03-29 10:00:00.000000000Z
    2025-03-29 11:00:00.000000000Z
    2025-03-29 12:00:00.000000000Z
    2025-03-29 13:00:00.000000000Z
    2025-03-29 14:00:00.000000000Z
    2025-03-29 15:00:00.000000000Z
    2025-03-29 16:00:00.000000000Z
    2025-03-29 17:00:00.000000000Z
    2025-03-29 18:00:00.000000000Z
    2025-03-29 19:00:00.000000000Z
    2025-03-29 20:00:00.000000000Z
    2025-03-29 21:00:00.000000000Z
    2025-03-29 22:00:00.000000000Z
    2025-03-29 23:00:00.000000000Z
    2025-03-30 00:00:00.000000000Z
    2025-03-30 02:00:00.000000000+01:00
    2025-03-30 03:00:00.000000000+01:00
    2025-03-30 04:00:00.000000000+01:00
    2025-03-30 05:00:00.000000000+01:00
    2025-03-30 06:00:00.000000000+01:00
    2025-03-30 07:00:00.000000000+01:00
    2025-03-30 08:00:00.000000000+01:00
    2025-03-30 09:00:00.000000000+01:00
    2025-03-30 10:00:00.000000000+01:00
    2025-03-30 11:00:00.000000000+01:00
    2025-03-30 12:00:00.000000000+01:00
    2025-03-30 13:00:00.000000000+01:00
    2025-03-30 14:00:00.000000000+01:00
    2025-03-30 15:00:00.000000000+01:00
    2025-03-30 16:00:00.000000000+01:00
    2025-03-30 17:00:00.000000000+01:00
    2025-03-30 18:00:00.000000000+01:00
    2025-03-30 19:00:00.000000000+01:00
    2025-03-30 20:00:00.000000000+01:00
    2025-03-30 21:00:00.000000000+01:00
    2025-03-30 22:00:00.000000000+01:00
    2025-03-30 23:00:00.000000000+01:00
    2025-03-31 00:00:00.000000000+01:00
    2025-03-31 01:00:00.000000000+01:00
    2025-03-31 02:00:00.000000000+01:00
    2025-03-31 03:00:00.000000000+01:00
    2025-03-31 04:00:00.000000000+01:00
    |}]
;;
